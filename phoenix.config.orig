[BEGIN GLOBAL]
PERSISTENT_CONF_ENABLED=no #yes

CONTACT_APP_SERVER=1 #0: no, 1: yes
APP_SERVER_HOST=172.31.20.18
APP_SERVER_PORT=443

beaconing_app_server_host=beaconserver.accelops.com
beaconing_app_server_port=443

DATA_PATH=/data

PARSER_SERVER_HOST=172.31.20.18
PARSER_SERVER_PORT=7912

MON_SERVER_HOST=172.31.20.18
MON_SERVER_PORT=7900
MON_ROLE=phMonitorSupervisor

HTTP_CACHE_SERVER_PORT=7902

HEARTBEAT_INTERVAL=5
HEARTBEAT_TYPE=BOTH #LOG/HEARTBEAT/BOTH
HEARTBEAT_TIMEOUT=15 #how much time do we consider a process is dead...,
		     #if it's smaller than 15, it will be reset to 15
SERIOUS_HEARTBEAT_TIMEOUT=300 #how much time do we consider a exist process is a zombie...
			      #if it's smaller than 180, it will be reset to 180

TIME_OUT_BEFORE_EXIT=10
HARD_KILL_TIMEOUT=60

DEFAULT_LOG_LEVEL=INFO #ERROR, DEBUG, INFO
DEFAULT_LOG_DEST=SYSLOG|STDERR

BLADE_WORKER=
BLADE_AGENT=
BLADE_GENERIC=
BLADE_SUPERVISOR=

// both numbers are percentage
MAX_CPU=90	     # if it's smaller than 10, it will be set to 90
MAX_MEMORY=75	     # if it's smaller than 5, it will be reset to 75

RESTART_LIMIT=3	     #counts within X seconds
RESTART_WINDOW=300   #seconds

mq_enabled=true
cust_id=1
agent_id=1
agent_password=
# Do not change svn_local as the change will break functionality
svn_local=/opt/phoenix/Delta/
mail_server=
mail_recipient=
ph_max_threads=20

cainfo=/opt/phoenix/config/ca.crt
agent_key=/opt/phoenix/config/collector.prospecthills.net.key
agent_cert=/opt/phoenix/config/collector.prospecthills.net.crt

CACHE_PATH=/opt/phoenix/cache
value_group_change_uri=phoenix/rest/changeSet

system_services=<system><service><name>rsyslogd</name><method>pgrep rsyslogd</method></service></system>

PKT_LOSS_THRESHOLD=50

STATUS_INTERVAL=180

SOCKET_READ_TIMEOUT=60000   #60 sec
SOCKET_CONNECT_RETRY=300000 # 5 mins

SIZE_QUERY_PER_REQUEST=1500
NEW_REPORT_QUERY=TRUE

SUCCEED_SEND_THRESHOLD=100;

rest_cache_process_list=phParser,phDiscover,phPerfMonitor,phAgentManager,phDataManager,phQueryWorker,phQueryMaster,phRuleWorker,phRuleMaster,phReportWorker,phReportMaster,phIpIdentityWorker,phIpIdentityMaster,phReportLoader,phDataPurger # TODO-RUI: phCheckpoint

rest_cache_api_list=cmdb/event/type2group,config/applicationPackage,config/domain,config/EventForwardingRule,config/networkInterface,device/properties,devMaintenance,namedValue/Application,namedValue/ApplicationPackage,namedValue/BizService,namedValue/ChangeRecord,namedValue/CmdbReport,namedValue/DashboardColumn,namedValue/DataRepository,namedValue/Device,namedValue/EventCollector,namedValue/GeoCountry,namedValue/Group,namedValue/GroupUpdateSite,namedValue/MalwareIP,namedValue/MalwareProcess,namedValue/MalwareSite,namedValue/Metrics,namedValue/Network,namedValue/PerfCategory,namedValue/PerfObject,namedValue/RbacProfile,namedValue/Report,namedValue/Rule,namedValue/Service,namedValue/User,namedValue/Widget,namedValue/malwareHash,namedValue/openProxy,namedValue/UserAgent,system/rbac/eventQueryCondition,system/phoenixServer

rest_log_module_name=TRUE # TRUE or FALSE

http_global_cache_ttl = 86400
http_cache_check_interval = 1800
http_changeset_cache_ttl = 300
http_time_out=300 # max 5 minutes for big malware object

max_notification_in_xml=100
http_client_verify_peer=no

log_discover_upload_url=phoenix/rest/discovered/log

SUPER_SSH_TUNNEL_SERVER_PORT = 19999

PURGE_IDENTITY_LOCATION_OVER_MONTHS = 12
PURGE_IDENTITY_LOCATION_OVER_ROWS = 1000000

# Host Risk Score
vul_weight=0.6
security_inci_weight=0.3
other_inci_weight=0.1
vul_threshold=1
security_inci_threshold=3
other_inci_threshold=6
calculate_window_in_hour=24
vuln_decay_window_in_hour=72
[END GLOBAL]

#######################
# Parsed Shared Store #
#######################
[BEGIN PARSED_SHAREDSTORE]
       KEY=1010
       SEM_KEY=2010
       SIZE=536870912 # 512M = 536870912, 64M = 67108864, 30M = 31457280
       NUM_READERS=6
       WAIT_TIME=10000 #uint: mu sec
       READER_LAG_RESET_PCT=60 # integer, 0 means never reset
[END PARSED_SHAREDSTORE]

[BEGIN phMonitorSupervisor]
command_port=7900

module.phParser=true
module.phQueryMaster=true
module.phRuleMaster=true
module.phRuleWorker=true
module.phQueryWorker=true
module.phDataManager=true
module.phDiscover=true
module.phReportWorker=true
module.phReportMaster=true
module.phIpIdentityWorker=true
module.phIpIdentityMaster=true
module.phAgentManager=true
module.phCheckpoint=true
module.phPerfMonitor=true
module.phReportLoader=true
module.phBeaconEventPackager=true
module.phDataPurger=true

http_pull=true
http_pull_uri=phoenix/rest/sync
http_pull_timer=5 #seconds

system_services=<system type="phMonitorSupervisor"><service><name>httpd</name><method>head /etc/httpd/run/httpd.pid</method></service><service><name>glassfish</name><method>ps -ef | grep java | grep glassfish | grep -v pid | gawk '{print $2}'</method></service><service><name>pgsql DB</name><method>ps -ef | grep pgsql | grep postgres | grep -v pid | gawk '{print $2 }'</method></service></system>
[END phMonitorSupervisor]

[BEGIN phMonitorWorker]
command_port=7900

module.phParser=true
module.phQueryWorker=true
module.phRuleWorker=true
module.phDataManager=true
module.phReportWorker=true
module.phIpIdentityWorker=true
module.phPerfMonitor=true
module.phAgentManager=true
module.phCheckpoint=true
module.phBeaconEventPackager=true
http_pull=true
http_pull_uri=phoenix/rest/sync
http_pull_timer=5 #seconds

system_services=<system type="phMonitorWorker"><service><name>httpd</name><method>head /etc/httpd/run/httpd.pid</method></service></system>
[END phMonitorWorker]

[BEGIN phMonitorAgent]
command_port=7900

module.phParser=true
module.phAgentManager=true
module.phCheckpoint=true
module.phDiscover=true
module.phEventPackager=true
module.phPerfMonitor=true

http_pull=true
http_pull_uri=phoenix/rest/sync
http_pull_timer=5 #seconds
[END phMonitorAgent]

[BEGIN phMonitorReportServer]
command_port=7900
#module.phReportLoader=true
system_services=<system type="phMonitorReportServer"><service><name>pgsql DB</name><method>ps -ef | grep pgsql | grep postgres | grep 5432 | grep -v pid | gawk '{print $2 }'</method></service><service><name>Report DB</name><method>ps -ef | grep pgsql | grep postgres | grep 30000 | grep -v pid | gawk '{print $2 }'</method></service></system>
[END phMonitorReportServer]


[BEGIN phMonitorGenericServer]
command_port=7900
[END phMonitorGenericServer]

[BEGIN PHPARSER]
parsing_xml_dir=/opt/phoenix/config/xml
feed_event_method=0 #0: network, 1: code generates, 2: from file
feed_event_file=testIpIdentityModule.txt #testEvents.txt #testWinDHCPEvents.txt #testWinEventsTwoEvents.txt #testWinEvents.txt #testSnortEvents.txt #testMSIASEvents.txt #testCiscoCSAEvents.txt #testSquidEvents.txt #testAllCheckpointEvents.txt #testIISViaSnareEvents.txt #testCiscoIOSEvents.txt #testASAEvents.txt #testCiscoVPN3KEvents2.txt #testCiscoVPN3KEvents.txt #testWinOSPullEvents.txt #testCiscoACSEvents.txt #testRedHatLinuxEvents.txt #testBindDNSEvents.txt #testUTF8Events.txt #testSyslogNGEvents.txt #testPHRuleIncidentEvents.txt #testPHBoxEvents.txt #testCiscoIPSEvents.txt #testCiscoIPSEvents.txt
raw_sharedstore_size=268435456 #15M = 15728640, 64M = 67108864, 256M = 268435456
raw_sharedstore_wait_time=10000 #uint: mu sec
disp_raw_sharedstore_status=0 #1=yes 0=no
num_event=0 #0 = infinite
num_event_grabber=2
num_event_parser=16 #timeWithinSec requires at least 2 parser when former event will depend on later event
num_event_sequence_id=50000
unknown_event_skip_eps=50
writer_buffer_size=131072 #128K=131072 32K=32768 8K=8192
writer_buffer_flush_time=5
command_port=7914
listen_port_list=514,6100 #external,internal. Don't change the order and number of this list w/o understanding.
listen_tcp_port_list=514,1470
listen_tcp_timeout=60
listen_tls_port_list=6514
tls_certificate_file=/etc/pki/tls/certs/tls_self_signed.crt
tls_key_file=/etc/pki/tls/private/tls_self_signed.key
event_buffer_count_limit=50
event_buffer_clean_time=50
max_num_active_ips_agent_thread=10
max_num_notsoactive_ips_agent_thread=5
max_num_active_wmi_agent_thread=5
scenario_output=0 #0=no, 1=yes
stat_output=0 #0=no, 1=yes
stat_output_freq=30 #uint: sec
parser_server_host=172.31.20.18
parser_server_port=7912
parsing_upload_uri=phoenix/rest/discovered/log
discover_upload_interval=60
reader_id=99
collect_interval=15
saas_rept_dev_ip=
ccm_ftp_directory=                 # /opt/phoenix/cache/ccm
avaya_sftp_directory=              # /opt/phoenix/cache/avayaCM
airline_sls_directory=             # /opt/phoenix/cache/airline
airline_sls_directory_high=        # higher priority than above
airline_thread=2
incoming_log_cfg=                  # /opt/phoenix/cache/bluecoat
parser_ipport_uri=phoenix/rest/config/service
collector_info_uri=phoenix/rest/mgmt/collector/infoUpdate
parsers_xml_uri=phoenix/rest/device/parsers
collector_event_status_report_intv=60 ## seconds
collector_event_status_report_uri=phoenix/rest/mgmt/collector/uploadTime
geoip_file_dir=/opt/phoenix/resources
geoip_file_city=GeoLiteCity.dat
geoip_file_org=GeoIPOrg.dat
num_event_file_processor=2
minimal_eps_limit=20
eps_alloc_interval=180
elastic_eps_switch=1 #1=on 0=off
hard_guaranteed_eps=1 #1=hard 0=soft
use_dns_lookup=yes
iplocation_update_interval=15
dev_vul_size_limit=1048576 # 1 MB
dev_vul_time_interval=3600 # 1 Hr
dga_detector_freq_table=/opt/phoenix/config/dga_freq_table.txt.bi
[END PHPARSER]

[BEGIN PHPERFMONITOR]
command_port=7942
output_cmdbupdate_to_file=0 #0: no 1: yes
running_app_update_intv=-1
num_perf_mon_threads=30
interval_ping_jobs=120
num_recv_ping_threads=1
num_disk_trending_day=30
num_disk_trending_week=12
num_disk_trending_month=12
disk_trending_debug_mode=0 #1=yes 0=no
use_topo_from_file=0 # if non zero, the topo file is /opt/phoenix/bin/topo_test.xml
test_ping_results=0 # if non zero, the ping results are in file /opt/phoenix/bin/test_ping_results.txt
ping_suppression_threshold=175 # pkt loss pct to trigger event suppression check
ping_suppression_check_l2=0 # whether or not check L2 device
script_for_getting_process_owner= #via ssh: /cygdrive/c/user-process.bat;via telnet c:/user-process.bat
realtime_traffic_jitter_weight=10
realtime_traffic_latency_weight=20
realtime_traffic_pkt_loss_pct_weight=100
realtime_traffic_sent_recv_bits_per_sec_weight=10
transactional_traffic_jitter_weight=10
transactional_traffic_latency_weight=20
transactional_traffic_pkt_loss_pct_weight=30
transactional_traffic_sent_recv_bits_per_sec_weight=10
background_traffic_jitter_weight=30
background_traffic_latency_weight=40
background_traffic_pkt_loss_pct_weight=30
background_traffic_sent_recv_bits_per_sec_weight=10
[END PHPERFMONITOR]

[BEGIN phQueryWorker]
command_port=7916
reader=true
reader_id=0
max_num_thread_per_task=2
allow_attr_set_from_index=1
[END]

[BEGIN phQueryMaster]
command_port=7918
query_notification_path=phoenix/rest/notification
backupQueryStatusFile=false
maxQueryCacheDisk=1024 #MB
max_num_pgconn=30
num_export_thread=2
max_active_queries=100
trend_sample_points=100
num_summ_event_pollers=2
use_summ_event_file_end_mark=true
[END]

[BEGIN phDataManager]
command_port=7920
reader=true
reader_id=1
high_watermark=200000
low_watermark=190000
flush_events_high_watermark=600000
flush_events_low_watermark=550000
num_segment_mergers=1
num_perf_event_loaders=3
num_flow_event_loaders=2
num_misc_event_loaders=3
num_segment_flushers=2
max_num_events_per_seg=300000
num_db_spliters=2
max_num_events_per_seg_in_archive=15000000
max_writer_life=4200
max_main_writer_idle_time=600
max_sub_writer_idle_time=600
segment_merge_scan_interval=300
data_bucket_len=24
signature_type=sha256	# md2, md4, md5, sha, sha1, dss, dss1, ecdsa, sha224, sha256 or ripemd160
summ_event_file_time_range=7200 # default: one file for two hours summ events
[END]

[BEGIN Kafka]
#enable=false # true for enable, false for disable
#topic=test
#brokers=   #broker1:9092,broker2:9092  defines where the Producer can find a one or more Brokers to determine the Leader for each topic. This does not need to be the full set of Brokers in your cluster but should include at least two in case the first Broker is not available. No need to worry about figuring out which Broker is the leader for the topic (and partition), the Producer knows how to connect to the Broker and ask for the meta data then connect to the correct Broker.
partition=-1   #-1 for random partition
debug=  #A comma-separated list of debug contexts to enable: all,generic,broker,topic,metadata,producer,queue,msg,protocol
compression=snappy #none, gzip or snappy
thread_num=2
waiting_time_ms=5000
max_queue_size=4800000
max_batch_size=100000
[END]

[BEGIN phRuleMaster]
rule_master=127.0.0.1
load_rule_method=0   #0: app server, 1: from files
rule_directory=/opt/phoenix/test/rules/ # load from here when load_rule_method=1. Besure to include the last "/" (path separator)
report_incident_method=0 #0: to parser, 1: to file
incident_put_uri=phoenix/rest/notification
incident_report_file=/opt/phoenix/bin/ruleIncidents.xml # file to save incidents from rule engine
command_port=7922
default_bucket_duration=30
min_stat_points=2 #min num of profiled data points before triggering incidents
fire_internal_incident_frequency=60
deprecated_time=86400 #1 day
daily_count_threshold=100
incident_rate_short_term_time_gap = 1 #unit: minute
incident_rate_short_term_per_rule_limit = 20
incident_rate_short_term_all_rules_limit = 200;
incident_rate_long_term_time_gap = 60 #uint: minute
incident_rate_long_term_per_rule_limit = 300;
incident_rate_long_term_all_rules_limit = 3000;
auto_clear_security_incidents=0 #0 not system clear security incident; 1 system clear security incident
per_cust_groupby_entry_limit=100000
all_cust_groupby_entry_limit=500000
dropping_time_threshold=900 #unit is second, if value is not available or 0, means no dropping.
[END]

[BEGIN phRuleWorker]
command_port = 7924
reader=true
reader_id=2
[END]

[BEGIN phAgentManager]
command_port = 7926
msg_queue_size = 100
msg_queue_buf_size = 4096
max_active_process = 10
max_general_process = 2
max_event_fetch_active = 1000
max_event_fetch_general = 100
max_busy_count          = 500
default_sleep_active    = 5
default_sleep_general   = 10
default_sleep_sweeper   = 60
max_num_active_wmi_agent_thread = 10
wmi_pull_interval_scale = 1 #1 to 10
max_num_active_Office365_agent_thread = 1
max_num_active_box_agent_thread = 3
box_pull_file_limit = 500
box_pull_interval = 180
box_check_share_interval = 86400
max_num_active_cloudtrail_agent_thread = 1
cloudtrail_job_interval = 120
cloudtrail_msg_pull_interval = 30
cloudtrail_msg_pull_thread_num = 1
cloudtrail_file_parse_interval = 30
cloudtrail_file_parse_thread_num = 3
cloudtrail_max_file_num_in_sqs = 32
max_num_active_okta_agent_thread = 1
okta_user_list_file = /opt/phoenix/config/okta/all_user_list_%s.csv # %s is the placeholder of token
max_num_active_cctec_agent_thread = 3
max_num_active_fireamp_agent_thread = 1
max_num_active_salesforce_agent_thread = 1
salesforce_api_version=36.0
max_num_active_alertlogic_agent_thread = 1
max_num_active_cisco_aci_agent_thread = 1
[END]

[BEGIN phDiscover]
command_port = 7928
discover_get_uri =phoenix/rest/deviceInfo
discover_put_uri =phoenix/rest/discovered/discover
discover_service_path=phoenix/rest/config/service
discover_package_path=phoenix/rest/config/applicationPackage
task_status_put_uri=phoenix/rest/sync/task/status
discover_from_file=0 #0:from network; 1:from file
discover_file_dir=/opt/phoenix/config/discoverFile #not reqd if prev flag is 0
system_snmp_sysObjId_file=/opt/phoenix/config/systemSnmpSysObjId.csv
user_snmp_sysObjId_file=/opt/phoenix/config/userSnmpSysObjId.csv
snmpwalk_timeout = 300 # seconds
system_call_timeout = 300 # seconds
vm_discov_timeout = 900 # 15 minutes
snmpwalk_v1_packet_timeout = 5 # second
snmpwalk_v2_packet_timeout = 5 # second
bgp_max_discov_count = -1 # max number of auto discoveries in one hour (set to -1 to disable auto discover)
discover_compress_threshold = 2048
snmp_ping_times=5
wmi_ping_times=5
[END]

[BEGIN phReportMaster]
merge_intervals = 300, 900, 3600
command_port = 7934
num_merge_threads = 3
[END]

[BEGIN phReportWorker]
command_port = 7932
num_event_processors = 20
report_chunk_size = 5
event_chunk_size = 2000
output_interval = 300  # seconds
output_directory = /data/eventdb
load_report_method = 0        # 0: app server, 1: from files
load_report_dir = reportXML/  # load from here when load_report_method=1
reader=true
reader_id=3
[END]

[BEGIN phReportLoader]
load_intervals = 300 # comma separated list, could be 300, 900, 3600
command_port = 7935
num_load_threads = 3
upload_report_dir=/data/reportdb # for report server.
[END]

[BEGIN phValueGroup]
ip_range_threshold=4096
hash_size_cap=134217728
hash_size_factor=64
[END]

[BEGIN phIpIdentityMaster]
identity_master=127.0.0.1
identity_put_uri=phoenix/rest/discovered/userConnectivity
command_port=7938
identity_timeout_sec=2592000    # 30 * 24 * 60 * 60 sec = 30 days
dump_identities=false
fast_db_sync_intvl_sec=15
lazy_db_sync_intvl_sec=1800     # 30 * 60 = 30 minutes
[END]

[BEGIN phIpIdentityWorker]
command_port=7940
reader=true
reader_id=4
identity_definitions_file=/opt/phoenix/config/identityDef.xml
excluded_users_file=/opt/phoenix/config/exclIdentUsers.csv
identity_timeout_sec=2592000    # 30 * 24 * 60 * 60 sec = 30 days
dump_identities=false
[END]

[BEGIN phCheckpoint]
command_port = 7930
[END]

[BEGIN phEventPackager]
command_port = 7936
parser_server_upload_host=
svn_server_upload_host=
reader=true
reader_id=5
num_upload_threads=10 # number of uploading threads
max_num_event_files=10000 # number of latest event files to keep
max_num_svn_files=1000 # number of latest svn files to keep
server_upload_uri=phoenix/rest/system/systemConfigs/collectorUploadSvr
[END]

[BEGIN phBeaconEventPackager]
command_port = 7939
parser_server_upload_host=beaconserver.accelops.com
svn_server_upload_host=beaconserver.accelops.com
reader=true
reader_id=5
num_upload_threads=10 # number of uploading threads
max_num_event_files=10000 # number of latest event files to keep
max_num_svn_files=1000 # number of latest svn files to keep
beacon_server_upload_uri=phoenix/rest/system/systemConfigs/collectorUploadSvr
max_seconds_retry_beaconing_register=86400
[END]

[BEGIN phDataPurger]
command_port = 7937
check_eventdb_size=1
du_check_interval=86400
dir_access_check_timeout=10
num_db_splitters=2
max_num_events_per_seg=300000
max_num_events_per_seg_in_archive=600000
temp_split_directory=/data/eventdb/tmpSplit
show_sys_error_on_low_space=false
policy_based_retention=true
low_space_action_threshold=10 # action could be purge, or archive if archive dir is set
low_space_warning_threshold=20
enforce_policy_at_hour=22 # local hour of day to run policy enforcement
num_segment_mergers=1
segment_merge_scan_interval=300
[END]

[BEGIN profile]
min_heavy_hitter_flow_thresh = 10
min_distinct_remote_port = 2
store_raw_flow_event=no
max_connection_age = 120 # seconds
total_flow_threshold = 20
profile_reports_file=/opt/phoenix/data-definition/profile/ProfileReports.xml
db_name=/opt/phoenix/cache/profile.db
[END]
