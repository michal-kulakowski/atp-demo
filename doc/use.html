<!doctype html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Fortinet ATP Demo Script</title>
		<meta name="author" content="Michał&nbsp;Kułakowski">
		<link rel="stylesheet" href="css/style.css">
	</head>
	<body>
		<h1>Fortinet ATP Demo Script</h1>
		<p>Once you have demo data up and running (consult <i>README.md</i> for instructions), here you will find steps to execute the demo including talking points.</p>
		<table>
			<tr class="header_row">
				<td>What to do</td>
				<td>What to say</td>
				<td>Illustration</td>				
			</tr>
			<tr class="subheader_row">
				<td colspan="3">Preparation</td>
			</tr>
			<tr>
				<td>Log into your FortiSIEM appliance. Go to Incidents tab.
				</td>
				<td>
				</td>
				<td><a href="img/incidents_screen.png"><img src="img/thumbnails/incidents_screen.png"/></a>
				</td>
			</tr>
			<tr>
				<td>
					<p>Log onto your FortiSIEM appliance via ssh. Go to the folder where you have cloned the demo repository.</p>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr class="subheader_row">
				<td colspan="3">Execution</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
					<p>Recently Wannacry ransomware has taken much attention in the news. It has disrupted healthcare services in the UK, disabled ATM's, railway control systems and public display screens.</p>
					<p>What was different this time? For the first time ever ransomware got delivered as advanced, peristent threat which means attacker silently penetrated the network using Double Pulsar backdoor leaked from NSA, and only delivered ransomware payload 2 weeks later. Moreover the original infection mechanism was propagaing without uer intervention (worm style) making original infection paricularly quick. This is also the reason why, despite high profile of the attack, we still do not know attack vector behind it.</p>
					<p>Note that the vulnerability used by attacker was not zero day. Despite OS Vendors efforts to release fix early, there always will be some systems which cannot be patched on time either because it would break application or because OS management was skipped in product design phase (IoT).</p>
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<td>
					<p>Go to the ssh window and execute <code>bin/run.sh</code></p>
					<p>Switch back to web console, then talk through and hit refresh button.</p>
					<p>Observe <i>Wannacry attack detected</i> incident appear. It should take around 40 seconds from when script is run.</p>
				</td>
				<td>
					<p>Let us simulate the situation where future unknown variant of Wannacry gets installed somewhere on the network. Ideally it gets stopped on the perimeter, but that is not always possible. According to Verizon's 2016 <cite>Data Breach Investigation</cite> paper:
						<ul>
							<li>99% malware is only seen for 58 seconds or less</li>
							<li>99,5% malware is unique to organization under attack</li>
						</ul>
					</p>
					<p>On our simulated network there is FortiSanbox and FortiGate installed stopping all known threats on the spot and running analysis on the unknown ones. Sandboxing time is counted in minutes which means infections can be contained quickly across all organization and attack vectors but they cannot be ruled out.</p>
				</td>
				<td>
					<a href="img/incident_detected.png"><img src="img/thumbnails/incident_detected.png"/></a>
				</td>
			</tr>
			<tr>
				<td>
					<p>Select the right incident. Click <i>Edit Rule</i> button.</p>
				</td>
				<td>
					<p>As you san see incident is detected, let us have a look on the correlation logic behind and why does it take SIEM to find what has happened.</p>
					<p>The rule looks for two triggers happening in sequence, within 300 seconds time window AND relating to the same source IP address. The security devices firing those triggers may and typically will be distinct. Big chunk of SIEM value is normalizing events coming form different sources so that they cna be compared and observed together.</p>
					<p>In our demo scenario the first trigger was fired by logs from FortiSandbox which, upon analysis, found one payload downloaded over the web by one of the hosts to be high risk.</p>
					<p>The second one is having two alternate implementations, either of them is sufficient to generate incident. The latter is SMB traffic from host flowing to larger than usual numer of distinct destination. Traffic baseline is used for comparison. In our environment we do not have real devices and hence traffic baseline cannot be generated. For this reason simpler alternative is provided comparing amount of distinct SMB traffic targets to a static threshold. We will discuss all of them momentarily.</p>
				</td>
				<td><a href="img/rule_details.png"><img src="img/thumbnails/rule_details.png"/></a>
				</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<td>
				</td>
				<td>
				</td>
				<td>
				</td>
			</tr>
			<tr class="subheader_row">
				<td colspan="3">Summary</td>
			</tr>
			<tr>
				<td colspan="3">
				</td>
			</tr>
		</table>
	</body>
</html>